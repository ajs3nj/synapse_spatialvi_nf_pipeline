// Nextflow config for spatialvi + Synapse pipeline
// Designed to run on Seqera Tower with Synapse staging and result indexing

// Input (required): path to CSV samplesheet with Synapse IDs
params.input = null

// Synapse folder where result tarball(s) will be uploaded
params.results_parent_id = null

// Test mode: only stage from Synapse, create fastq tarball, and upload tarball back to Synapse (no spatialvi)
params.test_staging_only = false

// SpatialVI pipeline: Sage Bionetworks fork (https://github.com/sagebio-ada/spatialvi)
params.spatialvi_pipeline = 'sagebio-ada/spatialvi'
// Branch or tag to run (e.g. 'dev', 'main', or a release tag)
params.spatialvi_release = 'dev'
// Profile for spatialvi sub-run: 'docker' or 'singularity' (use singularity on Tower if no Docker)
params.spatialvi_profile = 'docker'

// Space Ranger reference (tar.gz); used by spatialvi for alignment/counting
params.spaceranger_reference = 's3://ntap-add5-project-tower-bucket/reference/refdata-gex-GRCh38-2020-A.tar.gz'
// Space Ranger probeset for FFPE/Cytassist (e.g. Visium Human Transcriptome Probe Set v2)
params.spaceranger_probeset = 's3://ntap-add5-project-tower-bucket/spatialvi_testing/Visium_Human_Transcriptome_Probe_Set_v2.0_GRCh38-2020-A.csv'
// Use cytaimage column (Cytassist tissue image) instead of image (brightfield) in spatialvi samplesheet
params.cytassist = false
params.outdir = './results'

// Profiles
profiles {

  docker {
    docker.enabled = true
    singularity.enabled = false
    podman.enabled = false
  }

  singularity {
    singularity.enabled = true
    singularity.autoMounts = true
    docker.enabled = false
    podman.enabled = false
  }

  tower {
    // Use with Seqera Tower; combine with docker or singularity
    process.executor = 'awsbatch'
    executor = 'awsbatch'
  }
}
